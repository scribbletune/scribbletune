!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n(require("fs")):"function"==typeof define&&define.amd?define(["fs"],n):"object"==typeof exports?exports.scribble=n(require("fs")):t.scribble=n(t.fs)}(window,(function(t){return function(t){var n={};function e(r){if(n[r])return n[r].exports;var o=n[r]={i:r,l:!1,exports:{}};return t[r].call(o.exports,o,o.exports,e),o.l=!0,o.exports}return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{enumerable:!0,get:r})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,n){if(1&n&&(t=e(t)),8&n)return t;if(4&n&&"object"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&n&&"string"!=typeof t)for(var o in t)e.d(r,o,function(n){return t[n]}.bind(null,o));return r},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,n){return Object.prototype.hasOwnProperty.call(t,n)},e.p="",e(e.s=6)}([function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isNote=function(t){return/^[a-gA-G](?:#|b)?\d$/.test(t)},n.expandStr=function(t){return t=(t=(t=(t=JSON.stringify(t.split(""))).replace(/,"\[",/g,", [")).replace(/"\[",/g,"[")).replace(/,"\]"/g,"]"),JSON.parse(t)},n.shuffle=function(t){var n=t.length-1;return t.forEach((function(e,r){var o=Math.round(Math.random()*n);t[r]=t[o],t[o]=e})),t},n.sizzleMap=function(t){void 0===t&&(t=127);var n=Math.PI,e=[n/6,n/4,n/3,n/2,2*n/3,3*n/4,5*n/6,n],r=[0,n/6,n/4,n/3,n/2,2*n/3,3*n/4,5*n/6];return r.reverse(),e.concat(r).map((function(n){return Math.round(Math.sin(n)*t)}))},n.pickOne=function(t){return t.length>1?t[Math.round(Math.random())]:t[0]},n.dice=function(){return!!Math.round(Math.random())},n.flat=function(t){return t.reduce((function(t,n){return t.concat(n)}),[])}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(5),o=e(0),i=r.ChordType.all(),a=o.flat(i.map((function(t){return t.aliases.concat([t.name])}))).filter(Boolean);n.getChord=function(t){if(o.isNote(t))throw new Error(t+" is not a chord!");var n=t.split("-"),e=r.Chord.tokenize(n[0]),i=e[0],a=e[1];"4"!==i[1]&&"5"!==i[1]||(a=i[1],i=i.replace(/\d/,""));var s={"4th":"4","5th":"5","7th":"7","9th":"9","11th":"11","13th":"13"};if(s[a]&&(a=s[a]),!r.ChordType.get(a))throw new TypeError("Invalid chord name: "+a);var c=r.Chord.get(i+a),u=i+(n[1]||4);return(c.intervals||[]).map((function(t){var n=r.Note.transpose(u,t);return r.Note.simplify(n)}))},n.chords=function(){var t={4:"4th",5:"5th",7:"7th",9:"9th",11:"11th",13:"13th"};return a.map((function(n){return/^\d+$/.test(n)&&t[n]?t[n]:n}))},n.addChord=function(t,n,e){r.ChordType.add(t,n,e)}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(5);n.getScale=function(t){t=(t=(t=t&&t.toLowerCase()).replace("#5p","#5P")).replace("#7m","#7M");var n=r.Scale.tokenize(t)[1];if(!r.ScaleType.get(n))throw new Error(t+" does not exist!");return r.Scale.get(t).notes.map(r.Note.simplify)},n.scales=function(){return r.Scale.names()}},function(t,n,e){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0});var o=e(0),i=e(1),a="undefined"!=typeof window&&e(7).browserClip,s={"1m":2048,"2m":4096,"3m":6144,"4m":8192,"1n":512,"2n":256,"4n":128,"8n":64,"16n":32};n.clip=function(t){if("string"==typeof(t=r(r({},{notes:["C4"],pattern:"x",shuffle:!1,sizzle:!1,sizzleReps:1,arpegiate:!1,subdiv:"4n",amp:100,accentLow:70,randomNotes:null,effects:[],offlineRendering:!1}),t||{})).notes&&(t.notes=t.notes.replace(/\s{2,}/g," "),t.notes=t.notes.split(" ")),t.notes=t.notes.map((function(t){if(o.isNote(t))return[t];if(Array.isArray(t))return t.forEach((function(t){if(!o.isNote(t))throw new TypeError("array must comprise valid notes")})),t;if(!Array.isArray(t)){var n=i.getChord(t);if(n&&n.length)return n}throw new Error("Chord "+t+" not found")})),/[^x\-_\[\]R]/.test(t.pattern))throw new TypeError("pattern can only comprise x - _ [ ], found "+t.pattern);if(t.shuffle&&(t.notes=o.shuffle(t.notes)),t.randomNotes&&"string"==typeof t.randomNotes&&(t.randomNotes=t.randomNotes.replace(/\s{2,}/g," "),t.randomNotes=t.randomNotes.split(/\s/)),t.randomNotes&&(t.randomNotes=t.randomNotes.map((function(t){return[t]}))),t.synth||t.instrument||t.sample||t.buffer||t.player||t.samples||t.sampler)return a(t);var n=[],e=0,c=function(r,o){r.forEach((function(r){if("string"==typeof r){var i=null;"x"===r&&(i=t.notes[e],e++),"R"===r&&(Math.round(Math.random())||t.randomNotes)&&(i=t.randomNotes?t.randomNotes[Math.round(Math.random()*(t.randomNotes.length-1))]:t.notes[e],e++),"x"!==r&&"-"!==r&&"R"!==r||n.push({note:i,length:o,level:"R"!==r||t.randomNotes?t.amp:t.accentLow}),"_"===r&&n.length&&(n[n.length-1].length+=o),e===t.notes.length&&(e=0)}Array.isArray(r)&&c(r,o/r.length)}))};if(c(o.expandStr(t.pattern),s[t.subdiv]||s["4n"]),t.sizzle){var u=[],m=!0===t.sizzle?"sin":t.sizzle,l=n.length,d=t.amp,p=t.sizzleReps,f=d/(l/p);if("sin"===m||"cos"===m)for(var h=0;h<l;h++){var P=Math[m](h*Math.PI/(l/p))*d;u.push(Math.round(Math.abs(P)))}if("rampUp"===m)for(P=0,h=0;h<l;h++)h%(l/p)==0?P=0:P+=f,u.push(Math.round(Math.abs(P)));if("rampDown"===m)for(P=d,h=0;h<l;h++)h%(l/p)==0?P=d:P-=f,u.push(Math.round(Math.abs(P)));for(h=0;h<u.length;h++)n[h].level=u[h]?u[h]:1}if(t.accent){if(/[^x\-]/.test(t.accent))throw new TypeError("Accent can only have x and - characters");for(var M=0,y=0,v=n;y<v.length;y++){var g=v[y];P="x"===t.accent[M]?t.amp:t.accentLow;t.sizzle&&(P=(g.level+P)/2),g.level=Math.round(P),(M+=1)===t.accent.length&&(M=0)}}return n}},function(t,n,e){(function(t){var e={};!function(t){var n=t.DEFAULT_VOLUME=90,e=(t.DEFAULT_DURATION=128,t.DEFAULT_CHANNEL=0,{midi_letter_pitches:{a:21,b:23,c:12,d:14,e:16,f:17,g:19},midiPitchFromNote:function(t){var n=/([a-g])(#+|b+)?([0-9]+)$/i.exec(t),r=n[1].toLowerCase(),o=n[2]||"";return 12*parseInt(n[3],10)+e.midi_letter_pitches[r]+("#"==o.substr(0,1)?1:-1)*o.length},ensureMidiPitch:function(t){return"number"!=typeof t&&/[^0-9]/.test(t)?e.midiPitchFromNote(t):parseInt(t,10)},midi_pitches_letter:{12:"c",13:"c#",14:"d",15:"d#",16:"e",17:"f",18:"f#",19:"g",20:"g#",21:"a",22:"a#",23:"b"},midi_flattened_notes:{"a#":"bb","c#":"db","d#":"eb","f#":"gb","g#":"ab"},noteFromMidiPitch:function(t,n){var r,o=0,i=t;n=n||!1;return t>23&&(i=t-12*(o=Math.floor(t/12)-1)),r=e.midi_pitches_letter[i],n&&r.indexOf("#")>0&&(r=e.midi_flattened_notes[r]),r+o},mpqnFromBpm:function(t){var n=Math.floor(6e7/t),e=[];do{e.unshift(255&n),n>>=8}while(n);for(;e.length<3;)e.push(0);return e},bpmFromMpqn:function(t){if(void 0!==t[0]){0;for(var n=0,e=t.length-1;e>=0;++n,--e)t[n]<<e}return Math.floor(6e7/t)},codes2Str:function(t){return String.fromCharCode.apply(null,t)},str2Bytes:function(t,n){if(n)for(;t.length/2<n;)t="0"+t;for(var e=[],r=t.length-1;r>=0;r-=2){var o=0===r?t[r]:t[r-1]+t[r];e.unshift(parseInt(o,16))}return e},translateTickTime:function(t){for(var n=127&t;t>>=7;)n<<=8,n|=127&t|128;for(var e=[];e.push(255&n),128&n;)n>>=8;return e}}),r=function(t){if(!this)return new r(t);!t||null===t.type&&void 0===t.type||null===t.channel&&void 0===t.channel||null===t.param1&&void 0===t.param1||(this.setTime(t.time),this.setType(t.type),this.setChannel(t.channel),this.setParam1(t.param1),this.setParam2(t.param2))};r.NOTE_OFF=128,r.NOTE_ON=144,r.AFTER_TOUCH=160,r.CONTROLLER=176,r.PROGRAM_CHANGE=192,r.CHANNEL_AFTERTOUCH=208,r.PITCH_BEND=224,r.prototype.setTime=function(t){this.time=e.translateTickTime(t||0)},r.prototype.setType=function(t){if(t<r.NOTE_OFF||t>r.PITCH_BEND)throw new Error("Trying to set an unknown event: "+t);this.type=t},r.prototype.setChannel=function(t){if(t<0||t>15)throw new Error("Channel is out of bounds.");this.channel=t},r.prototype.setParam1=function(t){this.param1=t},r.prototype.setParam2=function(t){this.param2=t},r.prototype.toBytes=function(){var t=[],n=this.type|15&this.channel;return t.push.apply(t,this.time),t.push(n),t.push(this.param1),void 0!==this.param2&&null!==this.param2&&t.push(this.param2),t};var o=function(t){if(!this)return new o(t);this.setTime(t.time),this.setType(t.type),this.setData(t.data)};o.SEQUENCE=0,o.TEXT=1,o.COPYRIGHT=2,o.TRACK_NAME=3,o.INSTRUMENT=4,o.LYRIC=5,o.MARKER=6,o.CUE_POINT=7,o.CHANNEL_PREFIX=32,o.END_OF_TRACK=47,o.TEMPO=81,o.SMPTE=84,o.TIME_SIG=88,o.KEY_SIG=89,o.SEQ_EVENT=127,o.prototype.setTime=function(t){this.time=e.translateTickTime(t||0)},o.prototype.setType=function(t){this.type=t},o.prototype.setData=function(t){this.data=t},o.prototype.toBytes=function(){if(!this.type)throw new Error("Type for meta-event not specified.");var t=[];if(t.push.apply(t,this.time),t.push(255,this.type),Array.isArray(this.data))t.push(this.data.length),t.push.apply(t,this.data);else if("number"==typeof this.data)t.push(1,this.data);else if(null!==this.data&&void 0!==this.data){t.push(this.data.length);var n=this.data.split("").map((function(t){return t.charCodeAt(0)}));t.push.apply(t,n)}else t.push(0);return t};var i=function(t){if(!this)return new i(t);var n=t||{};this.events=n.events||[]};i.START_BYTES=[77,84,114,107],i.END_BYTES=[0,255,47,0],i.prototype.addEvent=function(t){return this.events.push(t),this},i.prototype.addNoteOn=i.prototype.noteOn=function(t,o,i,a){return this.events.push(new r({type:r.NOTE_ON,channel:t,param1:e.ensureMidiPitch(o),param2:a||n,time:i||0})),this},i.prototype.addNoteOff=i.prototype.noteOff=function(t,o,i,a){return this.events.push(new r({type:r.NOTE_OFF,channel:t,param1:e.ensureMidiPitch(o),param2:a||n,time:i||0})),this},i.prototype.addNote=i.prototype.note=function(t,n,e,r,o){return this.noteOn(t,n,r,o),e&&this.noteOff(t,n,e,o),this},i.prototype.addChord=i.prototype.chord=function(t,n,e,r){if(!Array.isArray(n)&&!n.length)throw new Error("Chord must be an array of pitches");return n.forEach((function(n){this.noteOn(t,n,0,r)}),this),n.forEach((function(n,r){0===r?this.noteOff(t,n,e):this.noteOff(t,n)}),this),this},i.prototype.setInstrument=i.prototype.instrument=function(t,n,e){return this.events.push(new r({type:r.PROGRAM_CHANGE,channel:t,param1:n,time:e||0})),this},i.prototype.setTempo=i.prototype.tempo=function(t,n){return this.events.push(new o({type:o.TEMPO,data:e.mpqnFromBpm(t),time:n||0})),this},i.prototype.toBytes=function(){var t=0,n=[],r=i.START_BYTES,o=i.END_BYTES;this.events.forEach((function(e){var r=e.toBytes();t+=r.length,n.push.apply(n,r)})),t+=o.length;var a=e.str2Bytes(t.toString(16),4);return r.concat(a,n,o)};var a=function(t){if(!this)return new a(t);var n=t||{};if(n.ticks){if("number"!=typeof n.ticks)throw new Error("Ticks per beat must be a number!");if(n.ticks<=0||n.ticks>=32768||n.ticks%1!=0)throw new Error("Ticks per beat must be an integer between 1 and 32767!")}this.ticks=n.ticks||128,this.tracks=n.tracks||[]};a.HDR_CHUNKID="MThd",a.HDR_CHUNK_SIZE="\0\0\0",a.HDR_TYPE0="\0\0",a.HDR_TYPE1="\0",a.prototype.addTrack=function(t){return t?(this.tracks.push(t),this):(t=new i,this.tracks.push(t),t)},a.prototype.toBytes=function(){var t=this.tracks.length.toString(16),n=a.HDR_CHUNKID+a.HDR_CHUNK_SIZE;return parseInt(t,16)>1?n+=a.HDR_TYPE1:n+=a.HDR_TYPE0,n+=e.codes2Str(e.str2Bytes(t,2)),n+=String.fromCharCode(this.ticks/256,this.ticks%256),this.tracks.forEach((function(t){n+=e.codes2Str(t.toBytes())})),n},t.Util=e,t.File=a,t.Track=i,t.Event=r,t.MetaEvent=o}(e),null!==t?t.exports=e:null!==n?n=e:this.Midi=e}).call(this,e(12)(t))},function(t,n,e){"use strict";e.r(n),e.d(n,"AbcNotation",(function(){return F})),e.d(n,"Array",(function(){return o})),e.d(n,"Chord",(function(){return Vt})),e.d(n,"ChordType",(function(){return vt})),e.d(n,"Collection",(function(){return W})),e.d(n,"accToAlt",(function(){return y})),e.d(n,"altToAcc",(function(){return M})),e.d(n,"coordToInterval",(function(){return _})),e.d(n,"coordToNote",(function(){return A})),e.d(n,"decode",(function(){return p})),e.d(n,"deprecate",(function(){return a})),e.d(n,"distance",(function(){return S})),e.d(n,"encode",(function(){return l})),e.d(n,"fillStr",(function(){return i})),e.d(n,"interval",(function(){return C})),e.d(n,"isNamed",(function(){return s})),e.d(n,"isPitch",(function(){return c})),e.d(n,"note",(function(){return v})),e.d(n,"stepToLetter",(function(){return P})),e.d(n,"tokenizeInterval",(function(){return j})),e.d(n,"tokenizeNote",(function(){return b})),e.d(n,"transpose",(function(){return x})),e.d(n,"Core",(function(){return r})),e.d(n,"DurationValue",(function(){return zt})),e.d(n,"Interval",(function(){return Jt})),e.d(n,"Key",(function(){return Kn})),e.d(n,"Midi",(function(){return an})),e.d(n,"Mode",(function(){return te})),e.d(n,"Note",(function(){return wn})),e.d(n,"Pcset",(function(){return mt})),e.d(n,"Progression",(function(){return ne})),e.d(n,"Range",(function(){return re})),e.d(n,"RomanNumeral",(function(){return Dn})),e.d(n,"Scale",(function(){return se})),e.d(n,"ScaleType",(function(){return xt})),e.d(n,"TimeSignature",(function(){return pe})),e.d(n,"ChordDictionary",(function(){return Pe})),e.d(n,"PcSet",(function(){return he})),e.d(n,"ScaleDictionary",(function(){return Me})),e.d(n,"Tonal",(function(){return fe}));var r={};e.r(r),e.d(r,"accToAlt",(function(){return y})),e.d(r,"altToAcc",(function(){return M})),e.d(r,"coordToInterval",(function(){return _})),e.d(r,"coordToNote",(function(){return A})),e.d(r,"decode",(function(){return p})),e.d(r,"deprecate",(function(){return a})),e.d(r,"distance",(function(){return S})),e.d(r,"encode",(function(){return l})),e.d(r,"fillStr",(function(){return i})),e.d(r,"interval",(function(){return C})),e.d(r,"isNamed",(function(){return s})),e.d(r,"isPitch",(function(){return c})),e.d(r,"note",(function(){return v})),e.d(r,"stepToLetter",(function(){return P})),e.d(r,"tokenizeInterval",(function(){return j})),e.d(r,"tokenizeNote",(function(){return b})),e.d(r,"transpose",(function(){return x}));var o={};e.r(o),e.d(o,"compact",(function(){return q})),e.d(o,"permutations",(function(){return H})),e.d(o,"range",(function(){return U})),e.d(o,"rotate",(function(){return $})),e.d(o,"shuffle",(function(){return L})),e.d(o,"sortedNoteNames",(function(){return z})),e.d(o,"sortedUniqNoteNames",(function(){return B}));const i=(t,n)=>Array(Math.abs(n)+1).join(t);function a(t,n,e){return function(...r){return console.warn(`${t} is deprecated. Use ${n}.`),e.apply(this,r)}}function s(t){return null!==t&&"object"==typeof t&&"string"==typeof t.name}function c(t){return null!==t&&"object"==typeof t&&"number"==typeof t.step&&"number"==typeof t.alt}const u=[0,2,4,-1,1,3,5],m=u.map(t=>Math.floor(7*t/12));function l(t){const{step:n,alt:e,oct:r,dir:o=1}=t,i=u[n]+7*e;if(void 0===r)return[o*i];return[o*i,o*(r-m[n]-4*e)]}const d=[3,0,4,1,5,2,6];function p(t){const[n,e,r]=t,o=d[function(t){const n=(t+1)%7;return n<0?7+n:n}(n)],i=Math.floor((n+1)/7);if(void 0===e)return{step:o,alt:i,dir:r};return{step:o,alt:i,oct:e+4*i+m[o],dir:r}}const f={empty:!0,name:"",pc:"",acc:""},h=new Map,P=t=>"CDEFGAB".charAt(t),M=t=>t<0?i("b",-t):i("#",t),y=t=>"b"===t[0]?-t.length:t.length;function v(t){const n=h.get(t);if(n)return n;const e="string"==typeof t?function(t){const n=b(t);if(""===n[0]||""!==n[3])return f;const e=n[0],r=n[1],o=n[2],i=(e.charCodeAt(0)+3)%7,a=y(r),s=o.length?+o:void 0,c=l({step:i,alt:a,oct:s}),u=e+r+o,m=e+r,d=(I[i]+a+120)%12,p=void 0===s?(M=I[i]+a,v=12,(M%v+v)%v-1188):I[i]+a+12*(s+1),h=p>=0&&p<=127?p:null,P=void 0===s?null:440*Math.pow(2,(p-69)/12);var M,v;return{empty:!1,acc:r,alt:a,chroma:d,coord:c,freq:P,height:p,letter:e,midi:h,name:u,oct:s,pc:m,step:i}}(t):c(t)?v(function(t){const{step:n,alt:e,oct:r}=t,o=P(n);if(!o)return"";const i=o+M(e);return r||0===r?i+r:i}(t)):s(t)?v(t.name):f;return h.set(t,e),e}const g=/^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\d*)\s*(.*)$/;function b(t){const n=g.exec(t);return[n[1].toUpperCase(),n[2].replace(/x/g,"##"),n[3],n[4]]}function A(t){return v(p(t))}const I=[0,2,4,5,7,9,11];const T={empty:!0,name:"",acc:""},w=new RegExp("^([-+]?\\d+)(d{1,4}|m|M|P|A{1,4})|(AA|A|P|M|m|d|dd)([-+]?\\d+)$");function j(t){const n=w.exec(""+t);return null===n?["",""]:n[1]?[n[1],n[2]]:[n[4],n[3]]}const N={};function C(t){return"string"==typeof t?N[t]||(N[t]=function(t){const n=j(t);if(""===n[0])return T;const e=+n[0],r=n[1],o=(Math.abs(e)-1)%7,i="PMMPPMM"[o];if("M"===i&&"P"===r)return T;const a="M"===i?"majorable":"perfectable",s=""+e+r,c=e<0?-1:1,u=8===e||-8===e?e:c*(o+1),m=function(t,n){return"M"===n&&"majorable"===t||"P"===n&&"perfectable"===t?0:"m"===n&&"majorable"===t?-1:/^A+$/.test(n)?n.length:/^d+$/.test(n)?-1*("perfectable"===t?n.length:n.length+1):0}(a,r),d=Math.floor((Math.abs(e)-1)/7),p=c*(O[o]+m+12*d),f=(c*(O[o]+m)%12+12)%12,h=l({step:o,alt:m,oct:d,dir:c});return{empty:!1,name:s,num:e,q:r,step:o,alt:m,dir:c,type:a,simple:u,semitones:p,chroma:f,coord:h,oct:d}}(t)):c(t)?C(function(t){const{step:n,alt:e,oct:r=0,dir:o}=t;if(!o)return"";return(o<0?"-":"")+(n+1+7*r)+function(t,n){return 0===n?"majorable"===t?"M":"P":-1===n&&"majorable"===t?"m":n>0?i("A",n):i("d","perfectable"===t?n:n+1)}("M"==="PMMPPMM"[n]?"majorable":"perfectable",e)}(t)):s(t)?C(t.name):T}const O=[0,2,4,5,7,9,11];function _(t){const[n,e=0]=t;return C(p(7*n+12*e<0?[-n,-e,-1]:[n,e,1]))}function x(t,n){const e=v(t),r=C(n);if(e.empty||r.empty)return"";const o=e.coord,i=r.coord;return A(1===o.length?[o[0]+i[0]]:[o[0]+i[0],o[1]+i[1]]).name}function S(t,n){const e=v(t),r=v(n);if(e.empty||r.empty)return"";const o=e.coord,i=r.coord,a=i[0]-o[0];return _([a,2===o.length&&2===i.length?i[1]-o[1]:-Math.floor(7*a/12)]).name}const E=(t,n)=>Array(n+1).join(t),D=/^(_{1,}|=|\^{1,}|)([abcdefgABCDEFG])([,']*)$/;function k(t){const n=D.exec(t);return n?[n[1],n[2],n[3]]:["","",""]}function R(t){const[n,e,r]=k(t);if(""===e)return"";let o=4;for(let t=0;t<r.length;t++)o+=","===r.charAt(t)?-1:1;const i="_"===n[0]?n.replace(/_/g,"b"):"^"===n[0]?n.replace(/\^/g,"#"):"";return e.charCodeAt(0)>96?e.toUpperCase()+i+(o+1):e+i+o}function V(t){const n=v(t);if(n.empty||!n.oct)return"";const{letter:e,acc:r,oct:o}=n;return("b"===r[0]?r.replace(/b/g,"_"):r.replace(/#/g,"^"))+(o>4?e.toLowerCase():e)+(5===o?"":o>4?E("'",o-5):E(",",4-o))}var F={abcToScientificNotation:R,scientificToAbcNotation:V,tokenize:k,transpose:function(t,n){return V(x(R(t),n))},distance:function(t,n){return S(R(t),R(n))}};function U(t,n){return t<n?function(t,n){const e=[];for(;n--;e[n]=n+t);return e}(t,n-t+1):function(t,n){const e=[];for(;n--;e[n]=t-n);return e}(t,t-n+1)}function $(t,n){const e=n.length,r=(t%e+e)%e;return n.slice(r,e).concat(n.slice(0,r))}function q(t){return t.filter(t=>0===t||t)}function z(t){return t.map(t=>v(t)).filter(t=>!t.empty).sort((t,n)=>t.height-n.height).map(t=>t.name)}function B(t){return z(t).filter((t,n,e)=>0===n||t!==e[n-1])}function L(t,n=Math.random){let e,r,o=t.length;for(;o;)e=Math.floor(n()*o--),r=t[o],t[o]=t[e],t[e]=r;return t}function H(t){return 0===t.length?[[]]:H(t.slice(1)).reduce((n,e)=>n.concat(t.map((n,r)=>{const o=e.slice();return o.splice(r,0,t[0]),o})),[])}function G(t,n){return t<n?function(t,n){const e=[];for(;n--;e[n]=n+t);return e}(t,n-t+1):function(t,n){const e=[];for(;n--;e[n]=t-n);return e}(t,t-n+1)}function K(t,n){const e=n.length,r=(t%e+e)%e;return n.slice(r,e).concat(n.slice(0,r))}function Y(t){return t.filter(t=>0===t||t)}var W={compact:Y,permutations:function t(n){return 0===n.length?[[]]:t(n.slice(1)).reduce((t,e)=>t.concat(n.map((t,r)=>{const o=e.slice();return o.splice(r,0,n[0]),o})),[])},range:G,rotate:K,shuffle:function(t,n=Math.random){let e,r,o=t.length;for(;o;)e=Math.floor(n()*o--),r=t[o],t[o]=t[e],t[e]=r;return t}};const J={empty:!0,name:"",setNum:0,chroma:"000000000000",normalized:"000000000000",intervals:[]},Q=t=>Number(t).toString(2),X=t=>parseInt(t,2),Z=/^[01]{12}$/;function tt(t){return Z.test(t)}const nt={[J.chroma]:J};function et(t){const n=tt(t)?t:"number"==typeof(e=t)&&e>=0&&e<=4095?Q(t):Array.isArray(t)?function(t){if(0===t.length)return J.chroma;let n;const e=[0,0,0,0,0,0,0,0,0,0,0,0];for(let r=0;r<t.length;r++)n=v(t[r]),n.empty&&(n=C(t[r])),n.empty||(e[n.chroma]=1);return e.join("")}(t):(t=>t&&tt(t.chroma))(t)?t.chroma:J.chroma;var e;return nt[n]=nt[n]||function(t){const n=X(t),e=function(t){const n=t.split("");return n.map((t,e)=>K(e,n).join(""))}(t).map(X).filter(t=>t>=2048).sort()[0],r=Q(e),o=it(t);return{empty:!1,name:"",setNum:n,chroma:t,normalized:r,intervals:o}}(n)}const rt=a("Pcset.pcset","Pcset.get",et),ot=["1P","2m","2M","3m","3M","4P","5d","5P","6m","6M","7m","7M"];function it(t){const n=[];for(let e=0;e<12;e++)"1"===t.charAt(e)&&n.push(ot[e]);return n}function at(t,n=!0){const e=et(t).chroma.split("");return Y(e.map((t,r)=>{const o=K(r,e);return n&&"0"===o[0]?null:o.join("")}))}function st(t){const n=et(t).setNum;return t=>{const e=et(t).setNum;return n&&n!==e&&(e&n)===e}}function ct(t){const n=et(t).setNum;return t=>{const e=et(t).setNum;return n&&n!==e&&(e|n)===e}}function ut(t){const n=et(t);return t=>{const e=v(t);return n&&!e.empty&&"1"===n.chroma.charAt(e.chroma)}}var mt={get:et,chroma:t=>et(t).chroma,num:t=>et(t).setNum,intervals:t=>et(t).intervals,chromas:function(){return G(2048,4095).map(Q)},isSupersetOf:ct,isSubsetOf:st,isNoteIncludedIn:ut,isEqual:function(t,n){return et(t).setNum===et(n).setNum},filter:function(t){const n=ut(t);return t=>t.filter(n)},modes:at,pcset:rt};const lt={...J,name:"",quality:"Unknown",intervals:[],aliases:[]};let dt=[],pt={};function ft(t){return pt[t]||lt}const ht=a("ChordType.chordType","ChordType.get",ft);function Pt(){return dt.slice()}const Mt=a("ChordType.entries","ChordType.all",Pt);function yt(t,n,e){const r=function(t){const n=n=>-1!==t.indexOf(n);return n("5A")?"Augmented":n("3M")?"Major":n("5d")?"Diminished":n("3m")?"Minor":"Unknown"}(t),o={...et(t),name:e||"",quality:r,intervals:t,aliases:n};dt.push(o),o.name&&(pt[o.name]=o),pt[o.setNum]=o,pt[o.chroma]=o,o.aliases.forEach(t=>function(t,n){pt[n]=t}(o,t))}[["1P 3M 5P","major","M "],["1P 3M 5P 7M","major seventh","maj7 Δ ma7 M7 Maj7"],["1P 3M 5P 7M 9M","major ninth","maj9 Δ9"],["1P 3M 5P 7M 9M 13M","major thirteenth","maj13 Maj13"],["1P 3M 5P 6M","sixth","6 add6 add13 M6"],["1P 3M 5P 6M 9M","sixth/ninth","6/9 69"],["1P 3M 5P 7M 11A","lydian","maj#4 Δ#4 Δ#11"],["1P 3M 6m 7M","major seventh flat sixth","M7b6"],["1P 3m 5P","minor","m min -"],["1P 3m 5P 7m","minor seventh","m7 min7 mi7 -7"],["1P 3m 5P 7M","minor/major seventh","m/ma7 m/maj7 mM7 mMaj7 m/M7 -Δ7 mΔ"],["1P 3m 5P 6M","minor sixth","m6"],["1P 3m 5P 7m 9M","minor ninth","m9"],["1P 3m 5P 7m 9M 11P","minor eleventh","m11"],["1P 3m 5P 7m 9M 13M","minor thirteenth","m13"],["1P 3m 5d","diminished","dim ° o"],["1P 3m 5d 7d","diminished seventh","dim7 °7 o7"],["1P 3m 5d 7m","half-diminished","m7b5 ø"],["1P 3M 5P 7m","dominant seventh","7 dom"],["1P 3M 5P 7m 9M","dominant ninth","9"],["1P 3M 5P 7m 9M 13M","dominant thirteenth","13"],["1P 3M 5P 7m 11A","lydian dominant seventh","7#11 7#4"],["1P 3M 5P 7m 9m","dominant flat ninth","7b9"],["1P 3M 5P 7m 9A","dominant sharp ninth","7#9"],["1P 3M 7m 9m","altered","alt7"],["1P 4P 5P","suspended fourth","sus4"],["1P 2M 5P","suspended second","sus2"],["1P 4P 5P 7m","suspended fourth seventh","7sus4"],["1P 5P 7m 9M 11P","eleventh","11"],["1P 4P 5P 7m 9m","suspended fourth flat ninth","b9sus phryg"],["1P 5P","fifth","5"],["1P 3M 5A","augmented","aug + +5"],["1P 3M 5A 7M","augmented seventh","maj7#5 maj7+5 +maj7"],["1P 3M 5P 7M 9M 11A","major sharp eleventh (lydian)","maj9#11 Δ9#11"],["1P 2M 4P 5P","","sus24 sus4add9"],["1P 3M 13m","","Mb6"],["1P 3M 5A 7M 9M","","maj9#5 Maj9#5"],["1P 3M 5A 7m","","7#5 +7 7aug aug7"],["1P 3M 5A 7m 9A","","7#5#9 7alt"],["1P 3M 5A 7m 9M","","9#5 9+"],["1P 3M 5A 7m 9M 11A","","9#5#11"],["1P 3M 5A 7m 9m","","7#5b9"],["1P 3M 5A 7m 9m 11A","","7#5b9#11"],["1P 3M 5A 9A","","+add#9"],["1P 3M 5A 9M","","M#5add9 +add9"],["1P 3M 5P 6M 11A","","M6#11 M6b5 6#11 6b5"],["1P 3M 5P 6M 7M 9M","","M7add13"],["1P 3M 5P 6M 9M 11A","","69#11"],["1P 3M 5P 6m 7m","","7b6"],["1P 3M 5P 7M 9A 11A","","maj7#9#11"],["1P 3M 5P 7M 9M 11A 13M","","M13#11 maj13#11 M13+4 M13#4"],["1P 3M 5P 7M 9m","","M7b9"],["1P 3M 5P 7m 11A 13m","","7#11b13 7b5b13"],["1P 3M 5P 7m 13M","","7add6 67 7add13"],["1P 3M 5P 7m 9A 11A","","7#9#11 7b5#9"],["1P 3M 5P 7m 9A 11A 13M","","13#9#11"],["1P 3M 5P 7m 9A 11A 13m","","7#9#11b13"],["1P 3M 5P 7m 9A 13M","","13#9"],["1P 3M 5P 7m 9A 13m","","7#9b13"],["1P 3M 5P 7m 9M 11A","","9#11 9+4 9#4"],["1P 3M 5P 7m 9M 11A 13M","","13#11 13+4 13#4"],["1P 3M 5P 7m 9M 11A 13m","","9#11b13 9b5b13"],["1P 3M 5P 7m 9m 11A","","7b9#11 7b5b9"],["1P 3M 5P 7m 9m 11A 13M","","13b9#11"],["1P 3M 5P 7m 9m 11A 13m","","7b9b13#11 7b9#11b13 7b5b9b13"],["1P 3M 5P 7m 9m 13M","","13b9"],["1P 3M 5P 7m 9m 13m","","7b9b13"],["1P 3M 5P 7m 9m 9A","","7b9#9"],["1P 3M 5P 9M","","Madd9 2 add9 add2"],["1P 3M 5P 9m","","Maddb9"],["1P 3M 5d","","Mb5"],["1P 3M 5d 6M 7m 9M","","13b5"],["1P 3M 5d 7M","","M7b5"],["1P 3M 5d 7M 9M","","M9b5"],["1P 3M 5d 7m","","7b5"],["1P 3M 5d 7m 9M","","9b5"],["1P 3M 7m","","7no5"],["1P 3M 7m 13m","","7b13"],["1P 3M 7m 9M","","9no5"],["1P 3M 7m 9M 13M","","13no5"],["1P 3M 7m 9M 13m","","9b13"],["1P 3m 4P 5P","","madd4"],["1P 3m 5A","","m#5 m+ mb6"],["1P 3m 5P 6M 9M","","m69"],["1P 3m 5P 6m 7M","","mMaj7b6"],["1P 3m 5P 6m 7M 9M","","mMaj9b6"],["1P 3m 5P 7M 9M","","mMaj9"],["1P 3m 5P 7m 11P","","m7add11 m7add4"],["1P 3m 5P 9M","","madd9"],["1P 3m 5d 6M 7M","","o7M7"],["1P 3m 5d 7M","","oM7"],["1P 3m 6m 7M","","mb6M7"],["1P 3m 6m 7m","","m7#5"],["1P 3m 6m 7m 9M","","m9#5"],["1P 3m 6m 7m 9M 11P","","m11A"],["1P 3m 6m 9m","","mb6b9"],["1P 2M 3m 5d 7m","","m9b5"],["1P 4P 5A 7M","","M7#5sus4"],["1P 4P 5A 7M 9M","","M9#5sus4"],["1P 4P 5A 7m","","7#5sus4"],["1P 4P 5P 7M","","M7sus4"],["1P 4P 5P 7M 9M","","M9sus4"],["1P 4P 5P 7m 9M","","9sus4 9sus"],["1P 4P 5P 7m 9M 13M","","13sus4 13sus"],["1P 4P 5P 7m 9m 13m","","7sus4b9b13 7b9b13sus4"],["1P 4P 7m 10m","","4 quartal"],["1P 5P 7m 9m 11P","","11b9"]].forEach(([t,n,e])=>yt(t.split(" "),e.split(" "),n)),dt.sort((t,n)=>t.setNum-n.setNum);var vt={names:function(){return dt.map(t=>t.name).filter(t=>t)},symbols:function(){return dt.map(t=>t.aliases[0]).filter(t=>t)},get:ft,all:Pt,add:yt,removeAll:function(){dt=[],pt={}},keys:function(){return Object.keys(pt)},entries:Mt,chordType:ht};const gt={weight:0,name:""};function bt(t){const n=t.map(t=>v(t).pc).filter(t=>t);if(0===v.length)return[];return function(t,n){const e=t[0],r=v(e).chroma,o=(t=>{const n=t.reduce((t,n)=>{const e=v(n).chroma;return void 0!==e&&(t[e]=t[e]||v(n).name),t},{});return t=>n[t]})(t),i=at(t,!1);return i.map((t,i)=>{const a=ft(t).aliases[0];if(!a)return gt;const s=o(i);return i!==r?{weight:.5*n,name:`${s}${a}/${e}`}:{weight:1*n,name:`${s}${a}`}})}(n,1).filter(t=>t.weight).sort((t,n)=>n.weight-t.weight).map(t=>t.name)}const At={...J,intervals:[],aliases:[]};let It=[],Tt={};function wt(){return It.map(t=>t.name)}function jt(t){return Tt[t]||At}const Nt=a("ScaleDictionary.scaleType","ScaleType.get",jt);function Ct(){return It.slice()}const Ot=a("ScaleDictionary.entries","ScaleType.all",Ct);function _t(t,n,e=[]){const r={...et(t),name:n,intervals:t,aliases:e};return It.push(r),Tt[r.name]=r,Tt[r.setNum]=r,Tt[r.chroma]=r,r.aliases.forEach(t=>function(t,n){Tt[n]=t}(r,t)),r}[["1P 2M 3M 5P 6M","major pentatonic","pentatonic"],["1P 3M 4P 5P 7M","ionian pentatonic"],["1P 3M 4P 5P 7m","mixolydian pentatonic","indian"],["1P 2M 4P 5P 6M","ritusen"],["1P 2M 4P 5P 7m","egyptian"],["1P 3M 4P 5d 7m","neopolitan major pentatonic"],["1P 3m 4P 5P 6m","vietnamese 1"],["1P 2m 3m 5P 6m","pelog"],["1P 2m 4P 5P 6m","kumoijoshi"],["1P 2M 3m 5P 6m","hirajoshi"],["1P 2m 4P 5d 7m","iwato"],["1P 2m 4P 5P 7m","in-sen"],["1P 3M 4A 5P 7M","lydian pentatonic","chinese"],["1P 3m 4P 6m 7m","malkos raga"],["1P 3m 4P 5d 7m","locrian pentatonic","minor seven flat five pentatonic"],["1P 3m 4P 5P 7m","minor pentatonic","vietnamese 2"],["1P 3m 4P 5P 6M","minor six pentatonic"],["1P 2M 3m 5P 6M","flat three pentatonic","kumoi"],["1P 2M 3M 5P 6m","flat six pentatonic"],["1P 2m 3M 5P 6M","scriabin"],["1P 3M 5d 6m 7m","whole tone pentatonic"],["1P 3M 4A 5A 7M","lydian #5P pentatonic"],["1P 3M 4A 5P 7m","lydian dominant pentatonic"],["1P 3m 4P 5P 7M","minor #7M pentatonic"],["1P 3m 4d 5d 7m","super locrian pentatonic"],["1P 2M 3m 4P 5P 7M","minor hexatonic"],["1P 2A 3M 5P 5A 7M","augmented"],["1P 2M 3m 3M 5P 6M","major blues"],["1P 2M 4P 5P 6M 7m","piongio"],["1P 2m 3M 4A 6M 7m","prometheus neopolitan"],["1P 2M 3M 4A 6M 7m","prometheus"],["1P 2m 3M 5d 6m 7m","mystery #1"],["1P 2m 3M 4P 5A 6M","six tone symmetric"],["1P 2M 3M 4A 5A 7m","whole tone","messiaen's mode #1"],["1P 2m 4P 4A 5P 7M","messiaen's mode #5"],["1P 3m 4P 5d 5P 7m","minor blues","blues"],["1P 2M 3M 4P 5d 6m 7m","locrian major","arabian"],["1P 2m 3M 4A 5P 6m 7M","double harmonic lydian"],["1P 2M 3m 4P 5P 6m 7M","harmonic minor"],["1P 2m 3m 3M 5d 6m 7m","altered","super locrian","diminished whole tone","pomeroy"],["1P 2M 3m 4P 5d 6m 7m","locrian #2","half-diminished","aeolian b5"],["1P 2M 3M 4P 5P 6m 7m","mixolydian b6","melodic minor fifth mode","hindu"],["1P 2M 3M 4A 5P 6M 7m","lydian dominant","lydian b7","overtone"],["1P 2M 3M 4A 5P 6M 7M","lydian"],["1P 2M 3M 4A 5A 6M 7M","lydian augmented"],["1P 2m 3m 4P 5P 6M 7m","dorian b2","phrygian #6","melodic minor second mode"],["1P 2M 3m 4P 5P 6M 7M","melodic minor"],["1P 2m 3m 4P 5d 6m 7m","locrian"],["1P 2m 3m 4d 5d 6m 7d","ultralocrian","superlocrian bb7","·superlocrian diminished"],["1P 2m 3m 4P 5d 6M 7m","locrian 6","locrian natural 6","locrian sharp 6"],["1P 2A 3M 4P 5P 5A 7M","augmented heptatonic"],["1P 2M 3m 5d 5P 6M 7m","romanian minor"],["1P 2M 3m 4A 5P 6M 7m","dorian #4"],["1P 2M 3m 4A 5P 6M 7M","lydian diminished"],["1P 2m 3m 4P 5P 6m 7m","phrygian"],["1P 2M 3M 4A 5A 7m 7M","leading whole tone"],["1P 2M 3M 4A 5P 6m 7m","lydian minor"],["1P 2m 3M 4P 5P 6m 7m","phrygian dominant","spanish","phrygian major"],["1P 2m 3m 4P 5P 6m 7M","balinese"],["1P 2m 3m 4P 5P 6M 7M","neopolitan major"],["1P 2M 3m 4P 5P 6m 7m","aeolian","minor"],["1P 2M 3M 4P 5P 6m 7M","harmonic major"],["1P 2m 3M 4P 5P 6m 7M","double harmonic major","gypsy"],["1P 2M 3m 4P 5P 6M 7m","dorian"],["1P 2M 3m 4A 5P 6m 7M","hungarian minor"],["1P 2A 3M 4A 5P 6M 7m","hungarian major"],["1P 2m 3M 4P 5d 6M 7m","oriental"],["1P 2m 3m 3M 4A 5P 7m","flamenco"],["1P 2m 3m 4A 5P 6m 7M","todi raga"],["1P 2M 3M 4P 5P 6M 7m","mixolydian","dominant"],["1P 2m 3M 4P 5d 6m 7M","persian"],["1P 2M 3M 4P 5P 6M 7M","major","ionian"],["1P 2m 3M 5d 6m 7m 7M","enigmatic"],["1P 2M 3M 4P 5A 6M 7M","major augmented","major #5","ionian augmented","ionian #5"],["1P 2A 3M 4A 5P 6M 7M","lydian #9"],["1P 2m 2M 4P 4A 5P 6m 7M","messiaen's mode #4"],["1P 2m 3M 4P 4A 5P 6m 7M","purvi raga"],["1P 2m 3m 3M 4P 5P 6m 7m","spanish heptatonic"],["1P 2M 3M 4P 5P 6M 7m 7M","bebop"],["1P 2M 3m 3M 4P 5P 6M 7m","bebop minor"],["1P 2M 3M 4P 5P 5A 6M 7M","bebop major"],["1P 2m 3m 4P 5d 5P 6m 7m","bebop locrian"],["1P 2M 3m 4P 5P 6m 7m 7M","minor bebop"],["1P 2M 3m 4P 5d 6m 6M 7M","diminished","whole-half diminished"],["1P 2M 3M 4P 5d 5P 6M 7M","ichikosucho"],["1P 2M 3m 4P 5P 6m 6M 7M","minor six diminished"],["1P 2m 3m 3M 4A 5P 6M 7m","half-whole diminished","dominant diminished","messiaen's mode #2"],["1P 3m 3M 4P 5P 6M 7m 7M","kafi raga"],["1P 2M 3M 4P 4A 5A 6A 7M","messiaen's mode #6"],["1P 2M 3m 3M 4P 5d 5P 6M 7m","composite blues"],["1P 2M 3m 3M 4A 5P 6m 7m 7M","messiaen's mode #3"],["1P 2m 2M 3m 4P 4A 5P 6m 6M 7M","messiaen's mode #7"],["1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M","chromatic"]].forEach(([t,n,...e])=>_t(t.split(" "),n,e));var xt={names:wt,get:jt,all:Ct,add:_t,removeAll:function(){It=[],Tt={}},keys:function(){return Object.keys(Tt)},entries:Ot,scaleType:Nt};const St={empty:!0,name:"",symbol:"",root:"",rootDegree:0,type:"",tonic:null,setNum:NaN,quality:"Unknown",chroma:"",normalized:"",aliases:[],notes:[],intervals:[]},Et=/^(6|64|7|9|11|13)$/;function Dt(t){const[n,e,r,o]=b(t);return""===n?["",t]:"A"===n&&"ug"===o?["","aug"]:o||"4"!==r&&"5"!==r?Et.test(r)?[n+e,r+o]:[n+e+r,o]:[n+e,r]}function kt(t){if(""===t)return St;if(Array.isArray(t)&&2===t.length)return Rt(t[1],t[0]);{const[n,e]=Dt(t),r=Rt(e,n);return r.empty?Rt(t):r}}function Rt(t,n,e){const r=ft(t),o=v(n||""),i=v(e||"");if(r.empty||n&&o.empty||e&&i.empty)return St;const a=S(o.pc,i.pc),s=r.intervals.indexOf(a)+1;if(!i.empty&&!s)return St;const c=o.empty?[]:r.intervals.map(t=>x(o,t));t=-1!==r.aliases.indexOf(t)?t:r.aliases[0];const u=`${o.empty?"":o.pc}${t}${i.empty?"":"/"+i.pc}`,m=`${n?o.pc+" ":""}${r.name}${e?" over "+i.pc:""}`;return{...r,name:m,symbol:u,type:r.name,root:i.name,rootDegree:s,tonic:o.name,notes:c}}var Vt={getChord:Rt,get:kt,detect:bt,chordScales:function(t){const n=ct(kt(t).chroma);return Ct().filter(t=>n(t.chroma)).map(t=>t.name)},extended:function(t){const n=kt(t),e=ct(n.chroma);return Pt().filter(t=>e(t.chroma)).map(t=>n.tonic+t.aliases[0])},reduced:function(t){const n=kt(t),e=st(n.chroma);return Pt().filter(t=>e(t.chroma)).map(t=>n.tonic+t.aliases[0])},tokenize:Dt,transpose:function(t,n){const[e,r]=Dt(t);return e?x(e,n)+r:t},chord:a("Chord.chord","Chord.get",kt)};const Ft=[];[[.125,"dl",["large","duplex longa","maxima","octuple","octuple whole"]],[.25,"l",["long","longa"]],[.5,"d",["double whole","double","breve"]],[1,"w",["whole","semibreve"]],[2,"h",["half","minim"]],[4,"q",["quarter","crotchet"]],[8,"e",["eighth","quaver"]],[16,"s",["sixteenth","semiquaver"]],[32,"t",["thirty-second","demisemiquaver"]],[64,"sf",["sixty-fourth","hemidemisemiquaver"]],[128,"h",["hundred twenty-eighth"]],[256,"th",["two hundred fifty-sixth"]]].forEach(([t,n,e])=>function(t,n,e){Ft.push({empty:!1,dots:"",name:"",value:1/t,fraction:t<1?[1/t,1]:[1,t],shorthand:n,names:e})}(t,n,e));const Ut={empty:!0,name:"",value:0,fraction:[0,0],shorthand:"",dots:"",names:[]};const $t=/^([^.]+)(\.*)$/;function qt(t){const[n,e,r]=$t.exec(t)||[],o=Ft.find(t=>t.shorthand===e||t.names.includes(e));if(!o)return Ut;const i=function(t,n){const e=Math.pow(2,n);let r=t[0]*e,o=t[1]*e;const i=r;for(let t=0;t<n;t++)r+=i/Math.pow(2,t+1);for(;r%2==0&&o%2==0;)r/=2,o/=2;return[r,o]}(o.fraction,r.length),a=i[0]/i[1];return{...o,name:t,dots:r,value:a,fraction:i}}var zt={names:function(){return Ft.reduce((t,n)=>(n.names.forEach(n=>t.push(n)),t),[])},shorthands:function(){return Ft.map(t=>t.shorthand)},get:qt,value:t=>qt(t).value,fraction:t=>qt(t).fraction};const Bt=C;const Lt=[1,2,2,3,3,4,5,5,6,6,7,7],Ht="P m M m M P d P m M m M".split(" ");const Gt=S,Kt=Wt((t,n)=>[t[0]+n[0],t[1]+n[1]]),Yt=Wt((t,n)=>[t[0]-n[0],t[1]-n[1]]);function Wt(t){return(n,e)=>{const r=C(n).coord,o=C(e).coord;if(r&&o){return _(t(r,o)).name}}}var Jt={names:function(){return"1P 2M 3M 4P 5P 6m 7m".split(" ")},get:Bt,name:t=>C(t).name,num:t=>C(t).num,semitones:t=>C(t).semitones,quality:t=>C(t).q,fromSemitones:function(t){const n=t<0?-1:1,e=Math.abs(t),r=e%12,o=Math.floor(e/12);return n*(Lt[r]+7*o)+Ht[r]},distance:Gt,invert:function(t){const n=C(t);return n.empty?"":C({step:(7-n.step)%7,alt:"perfectable"===n.type?-n.alt:-(n.alt+1),oct:n.oct,dir:n.dir}).name},simplify:function(t){const n=C(t);return n.empty?"":n.simple+n.q},add:Kt,addTo:t=>n=>Kt(t,n),substract:Yt};function Qt(t){return+t>=0&&+t<=127}function Xt(t){if(Qt(t))return+t;const n=v(t);return n.empty?null:n.midi}const Zt=Math.log(2),tn=Math.log(440);function nn(t){const n=12*(Math.log(t)-tn)/Zt+69;return Math.round(100*n)/100}const en="C C# D D# E F F# G G# A A# B".split(" "),rn="C Db D Eb E F Gb G Ab A Bb B".split(" ");function on(t,n={}){if(isNaN(t)||t===-1/0||t===1/0)return"";t=Math.round(t);const e=(!0===n.sharps?en:rn)[t%12];if(n.pitchClass)return e;return e+(Math.floor(t/12)-1)}var an={isMidi:Qt,toMidi:Xt,midiToFreq:function(t,n=440){return Math.pow(2,(t-69)/12)*n},midiToNoteName:on,freqToMidi:nn};const sn=["C","D","E","F","G","A","B"],cn=t=>t.name,un=t=>t.map(v).filter(t=>!t.empty);const mn=v;const ln=x,dn=x,pn=t=>n=>ln(n,t),fn=pn,hn=t=>n=>ln(t,n),Pn=hn;function Mn(t,n){const e=mn(t);if(e.empty)return"";const[r,o]=e.coord;return A(void 0===o?[r+n]:[r+n,o]).name}const yn=Mn,vn=(t,n)=>t.height-n.height;function gn(t,n){return n=n||vn,un(t).sort(n).map(cn)}function bn(t){return gn(t,vn).filter((t,n,e)=>0===n||t!==e[n-1])}const An=Tn(!0),In=Tn(!1);function Tn(t){return n=>{const e=mn(n);if(e.empty)return"";const r=t?e.alt>0:e.alt<0,o=null===e.midi;return on(e.midi||e.chroma,{sharps:r,pitchClass:o})}}var wn={names:function(t){return void 0===t?sn.slice():Array.isArray(t)?un(t).map(cn):[]},get:mn,name:t=>mn(t).name,pitchClass:t=>mn(t).pc,accidentals:t=>mn(t).acc,octave:t=>mn(t).oct,midi:t=>mn(t).midi,ascending:vn,descending:(t,n)=>n.height-t.height,sortedNames:gn,sortedUniqNames:bn,fromMidi:function(t){return on(t)},fromMidiSharps:function(t){return on(t,{sharps:!0})},freq:t=>mn(t).freq,fromFreq:function(t){return on(nn(t))},fromFreqSharps:function(t){return on(nn(t),{sharps:!0})},chroma:t=>mn(t).chroma,transpose:ln,tr:dn,transposeBy:pn,trBy:fn,transposeFrom:hn,trFrom:Pn,transposeFifths:Mn,trFifths:yn,simplify:An,enharmonic:In};const jn={empty:!0,name:"",chordType:""},Nn={};function Cn(t){return"string"==typeof t?Nn[t]||(Nn[t]=function(t){const[n,e,r,o]=(i=t,_n.exec(i)||["","","",""]);var i;if(!r)return jn;const a=r.toUpperCase(),s=Sn.indexOf(a),c=y(e);return{empty:!1,name:n,roman:r,interval:C({step:s,alt:c,dir:1}).name,acc:e,chordType:o,alt:c,step:s,major:r===a,oct:0,dir:1}}(t)):"number"==typeof t?Cn(Sn[t]||""):c(t)?Cn(M((n=t).alt)+Sn[n.step]):s(t)?Cn(t.name):jn;var n}const On=a("RomanNumeral.romanNumeral","RomanNumeral.get",Cn);const _n=/^(#{1,}|b{1,}|x{1,}|)(IV|I{1,3}|VI{0,2}|iv|i{1,3}|vi{0,2})([^IViv]*)$/;const xn="I II III IV V VI VII",Sn=xn.split(" "),En=xn.toLowerCase().split(" ");var Dn={names:function(t=!0){return(t?Sn:En).slice()},get:Cn,romanNumeral:On};const kn=Object.freeze([]),Rn={type:"major",tonic:"",alteration:0,keySignature:""},Vn={tonic:"",grades:kn,intervals:kn,scale:kn,chords:kn,chordsHarmonicFunction:kn,chordScales:kn},Fn={...Rn,...Vn,type:"major",minorRelative:"",scale:kn,secondaryDominants:kn,secondaryDominantsMinorRelative:kn,substituteDominants:kn,substituteDominantsMinorRelative:kn},Un={...Rn,type:"minor",relativeMajor:"",natural:Vn,harmonic:Vn,melodic:Vn},$n=(t,n,e="")=>n.map((n,r)=>`${t[r]}${e}${n}`);function qn(t,n,e,r){return o=>{const i=t.map(t=>Cn(t).interval||""),a=i.map(t=>x(o,t));return{tonic:o,grades:t,intervals:i,scale:a,chords:$n(a,n),chordsHarmonicFunction:$n(a,e),chordScales:$n(a,r," ")}}}const zn=(t,n)=>{const e=v(t),r=v(n);return e.empty||r.empty?0:r.coord[0]-e.coord[0]},Bn=qn("I II III IV V VI VII".split(" "),"maj7 m7 m7 maj7 7 m7 m7b5".split(" "),"T SD T SD D T D".split(" "),"major,dorian,phrygian,lydian,mixolydian,minor,locrian".split(",")),Ln=qn("I II bIII IV V bVI bVII".split(" "),"m7 m7b5 maj7 m7 m7 maj7 7".split(" "),"T SD T SD D SD SD".split(" "),"minor,locrian,major,dorian,phrygian,lydian,mixolydian".split(",")),Hn=qn("I II bIII IV V bVI VII".split(" "),"mMaj7 m7b5 +maj7 m7 7 maj7 o7".split(" "),"T SD T SD D SD D".split(" "),"harmonic minor,locrian 6,major augmented,lydian diminished,phrygian dominant,lydian #9,ultralocrian".split(",")),Gn=qn("I II bIII IV V VI VII".split(" "),"m6 m7 +maj7 7 7 m7b5 m7b5".split(" "),"T SD T SD D - -".split(" "),"melodic minor,dorian b2,lydian augmented,lydian dominant,mixolydian b6,locrian #2,altered".split(","));var Kn={majorKey:function(t){const n=v(t).pc;if(!n)return Fn;const e=Bn(n),r=zn("C",n),o=n=>{const e=Cn(n);return e.empty?"":x(t,e.interval)+e.chordType};return{...e,type:"major",minorRelative:x(n,"-3m"),alteration:r,keySignature:M(r),secondaryDominants:"- VI7 VII7 I7 II7 III7 -".split(" ").map(o),secondaryDominantsMinorRelative:"- IIIm7b5 IV#m7 Vm7 VIm7 VIIm7b5 -".split(" ").map(o),substituteDominants:"- bIII7 IV7 bV7 bVI7 bVII7 -".split(" ").map(o),substituteDominantsMinorRelative:"- IIIm7 Im7 IIbm7 VIm7 IVm7 -".split(" ").map(o)}},majorTonicFromKeySignature:function(t){return"number"==typeof t?Mn("C",t):"string"==typeof t&&/^b+|#+$/.test(t)?Mn("C",y(t)):null},minorKey:function(t){const n=v(t).pc;if(!n)return Un;const e=zn("C",n)-3;return{type:"minor",tonic:n,relativeMajor:x(n,"3m"),alteration:e,keySignature:M(e),natural:Ln(n),harmonic:Hn(n),melodic:Gn(n)}}};const Yn={...J,name:"",alt:0,modeNum:NaN,triad:"",seventh:"",aliases:[]},Wn=[[0,2773,0,"ionian","","Maj7","major"],[1,2902,2,"dorian","m","m7"],[2,3418,4,"phrygian","m","m7"],[3,2741,-1,"lydian","","Maj7"],[4,2774,1,"mixolydian","","7"],[5,2906,3,"aeolian","m","m7","minor"],[6,3434,5,"locrian","dim","m7b5"]].map((function(t){const[n,e,r,o,i,a,s]=t,c=s?[s]:[],u=Number(e).toString(2);return{empty:!1,intervals:it(u),modeNum:n,chroma:u,normalized:u,name:o,setNum:e,alt:r,triad:i,seventh:a,aliases:c}})),Jn={};function Qn(t){return"string"==typeof t?Jn[t.toLowerCase()]||Yn:t&&t.name?Qn(t.name):Yn}Wn.forEach(t=>{Jn[t.name]=t,t.aliases.forEach(n=>{Jn[n]=t})});const Xn=a("Mode.mode","Mode.get",Qn);function Zn(){return Wn.slice()}var te={get:Qn,names:function(){return Wn.map(t=>t.name)},all:Zn,entries:a("Mode.mode","Mode.all",Zn),mode:Xn};var ne={fromRomanNumerals:function(t,n){return n.map(Cn).map(n=>x(t,C(n))+n.chordType)},toRomanNumerals:function(t,n){return n.map(n=>{const[e,r]=Dt(n);return Cn(C(S(t,e))).name+r})}};function ee(t){const n=Y(t.map(Xt));return t.length&&n.length===t.length?n.reduce((t,n)=>{const e=t[t.length-1];return t.concat(G(e,n).slice(1))},[n[0]]):[]}var re={numeric:ee,chromatic:function(t,n){return ee(t).map(t=>on(t,n))}};const oe={empty:!0,name:"",type:"",tonic:null,setNum:NaN,chroma:"",normalized:"",aliases:[],notes:[],intervals:[]};function ie(t){if("string"!=typeof t)return["",""];const n=t.indexOf(" "),e=v(t.substring(0,n));if(e.empty){const n=v(t);return n.empty?["",t]:[n.name,""]}const r=t.substring(e.name.length+1);return[e.name,r.length?r:""]}function ae(t){const n=Array.isArray(t)?t:ie(t),e=v(n[0]).name,r=jt(n[1]);if(r.empty)return oe;const o=r.name,i=e?r.intervals.map(t=>x(e,t)):[],a=e?e+" "+o:o;return{...r,name:a,type:o,tonic:e,notes:i}}var se={get:ae,names:wt,extended:function(t){const n=ct(ae(t).chroma);return Ct().filter(t=>n(t.chroma)).map(t=>t.name)},modeNames:function(t){const n=ae(t);if(n.empty)return[];const e=n.tonic?n.notes:n.intervals;return at(n.chroma).map((t,n)=>{const r=ae(t).name;return r?[e[n],r]:["",""]}).filter(t=>t[0])},reduced:function(t){const n=st(ae(t).chroma);return Ct().filter(t=>n(t.chroma)).map(t=>t.name)},scaleChords:function(t){const n=st(ae(t).chroma);return Pt().filter(t=>n(t.chroma)).map(t=>t.aliases[0])},scaleNotes:function(t){const n=t.map(t=>v(t).pc).filter(t=>t),e=n[0],r=bn(n);return K(r.indexOf(e),r)},tokenize:ie,scale:a("Scale.scale","Scale.get",ae)};const ce={empty:!0,name:"",upper:void 0,lower:void 0,type:void 0,additive:[]},ue=["4/4","3/4","2/4","2/2","12/8","9/8","6/8","3/8"];const me=/^(\d?\d(?:\+\d)*)\/(\d)$/,le=new Map;function de(t){if("string"==typeof t){const[n,e,r]=me.exec(t)||[];return de([e,r])}const[n,e]=t,r=+e;if("number"==typeof n)return[n,r];const o=n.split("+").map(t=>+t);return 1===o.length?[o[0],r]:[o,r]}var pe={names:function(){return ue.slice()},parse:de,get:function(t){const n=le.get(t);if(n)return n;const e=function([t,n]){const e=Array.isArray(t)?t.reduce((t,n)=>t+n,0):t,r=n;if(0===e||0===r)return ce;const o=Array.isArray(t)?`${t.join("+")}/${n}`:`${t}/${n}`,i=Array.isArray(t)?t:[];return{empty:!1,name:o,type:4===r||2===r?"simple":8===r&&e%3==0?"compound":"irregular",upper:e,lower:r,additive:i}}(de(t));return le.set(t,e),e}};const fe=r,he=mt,Pe=vt,Me=xt},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(2);n.scale=r.getScale,n.mode=r.getScale,n.scales=r.scales,n.modes=r.scales;var o=e(1);n.addChord=o.addChord,n.chord=o.getChord,n.chords=o.chords;var i=e(3);n.clip=i.clip;var a=e(8);n.getChordDegrees=a.getChordDegrees,n.getChordsByProgression=a.getChordsByProgression,n.progression=a.progression;var s=e(9);n.arp=s.arp;var c=e(10);n.midi=c.midi;var u=e(13);n.Session=u.Session;var m=e(15);n.max=m.max},function(t,n,e){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)};Object.defineProperty(n,"__esModule",{value:!0});var o=e(0),i=function(t){return void 0===t&&(t=1),Math.round(Math.random()*t)},a=function(t,n,e){return"R"===t&&n.randomNotes?n.randomNotes[i(n.randomNotes.length-1)]:n.notes[e%n.notes.length]},s=function(t,n){return t.durations?t.durations[n%t.durations.length]:t.dur||t.subdiv||"8n"};n.recursivelyApplyPatternToDurations=function(t,e,r){return void 0===r&&(r=[]),t.forEach((function(t){"string"==typeof t&&("x"!==t&&"R"!==t||r.push(e),"_"===t&&r.length&&(r[r.length-1]+=e)),Array.isArray(t)&&n.recursivelyApplyPatternToDurations(t,e/t.length,r)})),r};var c=function(){return"13"===Tone.version.split(".")[0]},u=function(t){var e,r,u;if(!t.pattern)throw new Error("No pattern provided!");if(!(t.player||t.instrument||t.sample||t.buffer||t.synth||t.sampler||t.samples))throw new Error("No player or instrument provided!");t.durations||t.dur||(t.durations=n.recursivelyApplyPatternToDurations(o.expandStr(t.pattern),Tone.Ticks(t.subdiv||"4n").toSeconds()));var m,l=[];return t.effects&&(Array.isArray(t.effects)||(t.effects=[t.effects]),l=t.effects.map((function(t){var n="string"==typeof t?new Tone[t]:t;return c()?n.toMaster():n.toDestination()})).map((function(t){return"function"==typeof t.start?t.start():t}))),(t.sample||t.buffer)&&(t.player=new Tone.Player(t.sample||t.buffer)),t.samples&&(t.sampler=new Tone.Sampler(t.samples)),t.synth&&!t.instrument&&(console.warn('The "synth" parameter will be deprecated in the future. Please use the "instrument" parameter instead.'),t.instrument=new Tone[t.synth]),t.instrument&&"string"==typeof t.instrument&&(t.instrument=new Tone[t.instrument]),t.player?(t.volume&&(t.player.volume.value=t.volume),(e=t.player).chain.apply(e,l),c()?t.player.toMaster():t.player.toDestination(),new Tone.Sequence((m=t.player,function(t,n){("x"===n||"R"===n&&i())&&m.start(t)}),o.expandStr(t.pattern),t.subdiv||"4n")):t.sampler?(t.volume&&(t.sampler.volume.value=t.volume),(r=t.sampler).chain.apply(r,l),c()?t.sampler.toMaster():t.sampler.toDestination(),new Tone.Sequence(function(t){var n=0;return function(e,r){"x"!==r&&"R"!==r||(t.sampler.triggerAttackRelease(a(r,t,n),s(t,n),e),n++)}}(t),o.expandStr(t.pattern),t.subdiv||"4n")):t.instrument?(t.volume&&(t.instrument.volume.value=t.volume),(u=t.instrument).chain.apply(u,l),c()?t.instrument.toMaster():t.instrument.toDestination(),new Tone.Sequence(t.instrument instanceof Tone.PolySynth?function(t){var n=0;return function(e,r){"x"!==r&&"R"!==r||(t.instrument.triggerAttackRelease(a(r,t,n),s(t,n),e),n++)}}(t):function(t){var n=0;return function(e,r){"x"!==r&&"R"!==r||(t.instrument.triggerAttackRelease(a(r,t,n)[0],s(t,n),e),n++)}}(t),o.expandStr(t.pattern),t.subdiv||"4n")):void 0};n.totalPatternDuration=function(t,n){return"number"==typeof n?n*o.expandStr(t).length:Tone.Ticks(n).toSeconds()*o.expandStr(t).length};var m,l=0,d=0,p=function(t,n){return"PolySynth"===t.name?new Tone.PolySynth(Tone[t._dummyVoice.name],r(r({},t.get()),{context:n})):new Tone[t.name](r(r({},t.get()),{context:n}))};n.browserClip=function(t){if(t.offlineRendering)if(c())console.warn("Offline rendering not available for Tone <14. Please use Tone >=14.");else{if(!(t.sample||t.samples||t.buffer||t.player))return function(t,n){m||(m=Tone.getContext()),d++;var e=new Tone.Player({context:m,loop:!0}),r=l++;return console.log("Offline rendering of clip "+r+"..."),console.time("Offline rendering of clip "+r+" done"),Tone.Offline((function(n){var e=n.transport;t.instrument&&(t.instrument="string"!=typeof t.instrument?p(t.instrument,e.context):t.instrument),t.effects&&(Array.isArray(t.effects)||(t.effects=[t.effects]),t.effects=t.effects.map((function(t){return"string"!=typeof t?p(t,e.context):t}))),u(t).start(),e.start()}),n).then((function(t){e.buffer=t,0===--d&&Tone.setContext(m),console.timeEnd("Offline rendering of clip "+r+" done")})),e.toDestination(),e.sync(),e}(t,n.totalPatternDuration(t.pattern,t.subdiv||"4n"));console.warn("Offline rendering is not available for `sample`, `samples`, `buffer` or `player` parameters (buffer-based instruments). Please use only `synth` or `instrument` parameters.")}return u(t)}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(2),o=e(0);n.getChordDegrees=function(t){var n={ionian:["I","ii","iii","IV","V","vi","vii°"],dorian:["i","ii","III","IV","v","vi°","VII"],phrygian:["i","II","III","iv","v°","VI","vii"],lydian:["I","II","iii","iv°","V","vi","vii"],mixolydian:["I","ii","iii°","IV","v","vi","VII"],aeolian:["i","ii°","III","iv","v","VI","VII"],locrian:["i°","II","iii","iv","V","VI","vii"],"melodic minor":["i","ii","III+","IV","V","vi°","vii°"],"harmonic minor":["i","ii°","III+","iv","V","VI","vii°"]};return n.major=n.ionian,n.minor=n.aeolian,n[t]||[]};var i={i:0,ii:1,iii:2,iv:3,v:4,vi:5,vii:6};n.getChordsByProgression=function(t,n){var e=t.split(" ");e[0].match(/\d/)||(e[0]+="4",t=e.join(" "));var o=r.getScale(t);return n.replace(/\s*,+\s*/g," ").split(" ").map((function(t,n){var e=function(t){var n=t.replace(/\W/g,""),e="M";return n.toLowerCase()===n&&(e="m"),t.indexOf("°")>-1?e+"7b5":t.indexOf("+")>-1?e+"#5":t.indexOf("7")>-1?"M"===e?"Maj7":"m7":e}(t),r=i[t.replace(/\W|\d/g,"").toLowerCase()],a=o[r],s=a.replace(/\D+/,"");return a.replace(/\d/,"")+e+"-"+s})).toString().replace(/,/g," ")};var a=function(t){var n=t.T,e=t.P,r=t.D;return function(t){void 0===t&&(t=4);var i=[];i.push(o.pickOne(n));var a=1;for(a<t-1&&(i.push(o.pickOne(e)),a++),a<t-1&&o.dice()&&(i.push(o.pickOne(e)),a++),a<t-1&&(i.push(o.pickOne(r)),a++),a<t-1&&(i.push(o.pickOne(e)),a++),a<t-1&&(i.push(o.pickOne(r)),a++),a<t-1&&o.dice()&&(i.push(o.pickOne(e)),a++);a<t;)i.push(o.pickOne(r)),a++;return i}},s=a({T:["I","vi"],P:["ii","IV"],D:["V"]}),c=a({T:["i","VI"],P:["ii","iv"],D:["V"]});n.progression=function(t,n){return void 0===n&&(n=4),"major"===t||"M"===t?s(n):"minor"===t||"m"===t?c(n):void 0}},function(t,n,e){"use strict";var r=this&&this.__spreadArrays||function(){for(var t=0,n=0,e=arguments.length;n<e;n++)t+=arguments[n].length;var r=Array(t),o=0;for(n=0;n<e;n++)for(var i=arguments[n],a=0,s=i.length;a<s;a++,o++)r[o]=i[a];return r};Object.defineProperty(n,"__esModule",{value:!0});var o=e(1);n.arp=function(t){var n=[],e={count:4,order:"0123",chords:""};if("string"==typeof t)e.chords=t;else{if(t.order&&t.order.match(/\D/g))throw new TypeError("Invalid value for order");if(t.count>8||t.count<2)throw new TypeError("Invalid value for count");t.count&&!t.order&&(e.order=Array.from(Array(t.count).keys()).join("")),Object.assign(e,t)}for(var i=function(t){var i,a,s,c,u,m=(i=o.getChord(t),a=e.count,s=function(t){return t.replace(/\d/,"")+(+t.replace(/\D/g,"")+1)},c=i.map(s),u=c.map(s),r(i,c,u).slice(0,a)),l=e.order.split("").map((function(t){return m[t]}));n=r(n,l)},a=0,s=e.chords.split(" ");a<s.length;a++){i(s[a])}return n}},function(t,n,e){"use strict";var r=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},o=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var n={};if(null!=t)for(var e in t)Object.hasOwnProperty.call(t,e)&&(n[e]=t[e]);return n.default=t,n};Object.defineProperty(n,"__esModule",{value:!0});var i=r(e(11)),a=o(e(4));n.midi=function(t,n,e){void 0===n&&(n="music.mid");var r=c(t,e).toBytes();return null===n?r:(n.endsWith(".mid")||(n+=".mid"),"undefined"!=typeof window&&window.URL&&window.URL.createObjectURL?s(r,n):(i.default.writeFileSync(n,r,"binary"),void console.log("MIDI file generated: "+n+".")))};var s=function(t,n){for(var e=new Uint8Array(t.length),r=0;r<t.length;r++){var o=t.charCodeAt(r);e[r]=o}var i=new Blob([e],{type:"audio/midi"}),a=document.createElement("a");return a.href="undefined"!=typeof window&&void 0!==window.URL&&void 0!==window.URL.createObjectURL&&window.URL.createObjectURL(i)||"",a.download=n,a.innerText="Download MIDI file",a},c=function(t,n){var e=new a.File,r=new a.Track;"number"==typeof n&&r.setTempo(n),e.addTrack(r);for(var o=0,i=t;o<i.length;o++){var s=i[o],c=s.level||127;s.note?"string"==typeof s.note?(r.noteOn(0,s.note,s.length,c),r.noteOff(0,s.note,s.length,c)):r.addChord(0,s.note,s.length,c):r.noteOff(0,"",s.length)}return e}},function(n,e){n.exports=t},function(t,n){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(14),o=function(){function t(t){t=t||[],this.sessionChannels=t.map((function(t,n){return t.idx=t.idx||n,new r.Channel(t)}))}return t.prototype.createChannel=function(t){t.idx=t.idx||this.sessionChannels.length;var n=new r.Channel(t);return this.sessionChannels.push(n),n},Object.defineProperty(t.prototype,"channels",{get:function(){return this.sessionChannels},enumerable:!0,configurable:!0}),t.prototype.startRow=function(t){this.sessionChannels.forEach((function(n){n.startClip(t)}))},t}();n.Session=o},function(t,n,e){"use strict";var r=this&&this.__assign||function(){return(r=Object.assign||function(t){for(var n,e=1,r=arguments.length;e<r;e++)for(var o in n=arguments[e])Object.prototype.hasOwnProperty.call(n,o)&&(t[o]=n[o]);return t}).apply(this,arguments)},o=this&&this.__rest||function(t,n){var e={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&n.indexOf(r)<0&&(e[r]=t[r]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(r=Object.getOwnPropertySymbols(t);o<r.length;o++)n.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(e[r[o]]=t[r[o]])}return e};Object.defineProperty(n,"__esModule",{value:!0});var i=e(3),a=function(){var t=Tone.Transport.position.split(":");return"0"===t[0]&&"0"===t[1]?0:+t[0]+1+":0:0"},s=function(){function t(t){var n=this;this.idx=t.idx,this.activePatternIdx=-1,this.channelClips=[],t.sample&&(this.player=new Tone.Player(t.sample)),t.synth&&(this.instrument=new Tone[t.synth]),t.samples&&(this.sampler=new Tone.Sampler(t.samples));t.clips,t.samples,t.sample,t.synth;var e=o(t,["clips","samples","sample","synth"]);t.clips.forEach((function(t){n.addClip(r(r({},t),e))}),this)}return Object.defineProperty(t.prototype,"clips",{get:function(){return this.channelClips},enumerable:!0,configurable:!0}),t.prototype.startClip=function(t){this.activePatternIdx>-1&&this.activePatternIdx!==t&&this.stopClip(this.activePatternIdx),this.channelClips[t]&&"started"!==this.channelClips[t].state&&(this.activePatternIdx=t,this.channelClips[t].start(a()))},t.prototype.stopClip=function(t){this.channelClips[t].stop(a())},t.prototype.addClip=function(t,n){n=n||this.channelClips.length,t.pattern?this.channelClips[n]=i.clip(r({player:this.player,instrument:this.instrument,sampler:this.sampler},t)):this.channelClips[n]=null},Object.defineProperty(t.prototype,"activeClipIdx",{get:function(){return this.activePatternIdx},enumerable:!0,configurable:!0}),t}();n.Channel=s},function(t,n,e){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=e(4);n.max=function(t,n){void 0===n&&(n="live_set view highlighted_clip_slot clip");var e=new LiveAPI(n),o=t.reduce((function(t,n){return t+n.length}),0);e.set("loop_end",o/512),e.call("remove_notes",0,1,258,127),e.call("set_notes");var i=t.reduce((function(t,n){return t+(n.note?n.note.length:0)}),0);e.call("notes",i);var a=0;t.forEach((function(t){t.note?(t.note.forEach((function(n){e.call("note",r.Util.midiPitchFromNote(n),a.toFixed(2).toString(),(t.length/512).toFixed(2).toString(),t.level||100,0)})),a+=t.length/512):a+=t.length/512})),e.call("done")}}])}));
//# sourceMappingURL=scribbletune.js.map